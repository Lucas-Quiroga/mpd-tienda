import{j as e}from"./utils.BkWr051p.js";import{r as o}from"./index.DWKhlr8t.js";import{u as y,t as I,L as z,I as p,C as S}from"./zod.D019fbSG.js";import{T as D,C as F,p as L}from"./textarea.JxtdqJQD.js";import{u as P}from"./client.DGuP4OmD.js";import{S as A,a as T,b as V,c as O,e as U,f as R,d as B}from"./select.BVUqzJ9T.js";import{B as G}from"./button.CYrJCsL-.js";import{D as M}from"./const.D9r1vPbu.js";import{u as _,S as $}from"./spinner.BaEYq8AJ.js";import"./index.XeH8wQWu.js";import"./index.CeWXdII0.js";import"./index.DCM1_hEY.js";import"./index.COfBiRaR.js";import"./index.CauQR6HY.js";import"./check.Do7Pwu4i.js";import"./createLucideIcon.hjzkcH4V.js";import"./index.esm2017.CUxXeArW.js";import"./index.Bh8kkQoZ.js";import"./Combination.VnqCLJna.js";import"./tslib.es6.CDuPK5Eb.js";import"./chevron-down.C5B0BJFb.js";const pe=({product:s})=>{const[u,x]=o.useState(null),[h,N]=o.useState(null),[c,w]=o.useState(null),{execute:g,isLoading:f}=_(),{register:n,handleSubmit:C,control:j,setValue:b,formState:{errors:d}}=y({defaultValues:s,resolver:I(L)});o.useEffect(()=>{Object.entries(s).forEach(([t,a])=>{b(t,a)})},[s,b]);const k=o.useCallback(async t=>{try{c&&(t.image=await P(c));const a=new FormData;Object.entries(t).forEach(([m,i])=>{m==="avaliable"?a.append(m,i?"on":"off"):i!=null&&a.append(m,i.toString())});const r=await g(`/api/products/${s.id}`,{method:"POST",body:a});console.log(r),r?.data||x("Error al actualizar el producto"),r?.data&&(N("Producto actualizado exitosamente"),r.data.redirectUrl&&window.location.replace(r.data.redirectUrl))}catch(a){console.error(a),x(a instanceof Error?a.message:"Error al actualizar el producto")}},[g,c,s.id]),v=o.useCallback(t=>{t.target.files&&w(t.target.files[0])},[]),l=o.useCallback((t,a,r)=>e.jsxs("div",{className:"grid gap-2",children:[e.jsx(z,{htmlFor:a,className:"dark:text-white",children:t}),r,d[a]&&e.jsx("span",{className:"text-red-500",children:d[a]?.message})]}),[d]),E=o.useMemo(()=>M.categories,[]);return e.jsxs("section",{className:"flex flex-col gap-6 p-4 md:p-6 justify-center items-center h-[100vh]",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-white",children:"Actualizar Producto"}),e.jsxs("form",{onSubmit:C(k),className:"flex flex-col justify-center max-w-md m-0 p-0 gap-4",children:[h&&e.jsxs("div",{className:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 my-4",role:"alert",children:[e.jsx("p",{className:"font-bold",children:"Producto actualizado exitosamente"}),e.jsx("p",{children:h})]}),u&&e.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 my-4",role:"alert",children:[e.jsx("p",{className:"font-bold",children:"Error al actualizar el producto"}),e.jsx("p",{children:u})]}),l("Nombre","name",e.jsx(p,{id:"name",type:"text",placeholder:"Ingresa el nombre del producto",...n("name"),className:"dark:text-white"})),l("Imagen Actual","image",e.jsx("img",{src:s.image,alt:"product",className:"w-1/2 object-contain mx-auto dark:text-white"})),l("Cambiar imagen","image",e.jsx(p,{type:"file",onChange:v,className:"dark:text-white"})),c&&e.jsx("img",{src:URL.createObjectURL(c),alt:"product",className:"w-1/2 object-contain mx-auto dark:text-white"}),l("Descripción","description",e.jsx(D,{id:"description",placeholder:"Ingresa la descripción del producto",...n("description"),maxLength:210,className:"dark:text-white"})),l("Precio","price",e.jsx(p,{id:"price",type:"number",placeholder:"Ingresa el precio del producto",...n("price"),className:"dark:text-white"})),l("Disponible","avaliable",e.jsx(S,{name:"avaliable",control:j,defaultValue:s.avaliable,render:({field:t})=>e.jsx(F,{id:"avaliable",checked:t.value,onCheckedChange:a=>t.onChange(a)})})),l("Categoría","category",e.jsx(S,{name:"category",control:j,defaultValue:s.category,render:({field:t})=>e.jsxs(A,{value:t.value,onValueChange:t.onChange,children:[e.jsx(T,{className:"w-full dark:text-white",children:e.jsx(V,{placeholder:"Selecciona la categoría"})}),e.jsx(O,{children:e.jsxs(U,{children:[e.jsx(R,{children:"Categorías"}),E.map((a,r)=>e.jsx(B,{value:a,children:a},r))]})})]})})),e.jsx(G,{type:"submit",disabled:f,className:"w-full",children:f?e.jsx($,{size:"medium"}):"Actualizar Producto"})]})]})};export{pe as default};
